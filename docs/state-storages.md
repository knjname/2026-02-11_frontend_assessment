# フロントエンドの状態ストレージ一覧

現状の構成（React state + Valtio + TanStack Router + TanStack Query）の全体像。

| ストレージ           | スコープ       | 保持するもの                                 | ライフサイクル                                | 無効化                            |
| -------------------- | -------------- | -------------------------------------------- | --------------------------------------------- | --------------------------------- |
| **React `useState`** | コンポーネント | ローカルUI状態（フォーム入力、開閉状態など） | コンポーネントのマウント〜アンマウント        | `setState`                        |
| **Valtio (`proxy`)** | グローバル     | アプリ全体で共有する状態（認証情報など）     | アプリ起動〜終了（メモリ上）                  | `store.xxx = ...` で直接書き換え  |
| **TanStack Router**  | ルート単位     | `loader` の戻り値                            | ルート登録〜画面遷移で破棄（staleTime経過後） | `router.invalidate()`             |
| **TanStack Query**   | クエリキー単位 | API レスポンスのキャッシュ                   | `gcTime`（デフォルト5分）で自動GC             | `queryClient.invalidateQueries()` |

## 役割分担

- **React state** — 1つのコンポーネント内で完結するUI状態
- **Valtio** — 認証トークンなどコンポーネントをまたぐクライアントサイド状態
- **TanStack Router** — ルート遷移時のデータ取得とナビゲーション状態
- **TanStack Query** — サーバーデータのキャッシュ・再取得・楽観的更新（ミューテーション後の `invalidateQueries()` でキャッシュを無効化）
